# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ TDD —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ –≤ TDD](#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-tdd)
2. [–ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤](#–∞–ª–≥–æ—Ä–∏—Ç–º-–Ω–∞–ø–∏—Å–∞–Ω–∏—è-—Ç–µ—Å—Ç–æ–≤)
3. [–¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏](#—Ç–∏–ø—ã-—Ç–µ—Å—Ç–æ–≤-–ø–æ-–æ–±–ª–∞—Å—Ç–∏-–≤–∏–¥–∏–º–æ—Å—Ç–∏)
4. [–¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º](#—Ç–∏–ø—ã-—Ç–µ—Å—Ç–æ–≤-–ø–æ-—Å—Ü–µ–Ω–∞—Ä–∏—è–º)
5. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º –∫–ª–∞—Å—Å–æ–≤](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø–æ-—Ç–∏–ø–∞–º-–∫–ª–∞—Å—Å–æ–≤)
6. [–ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏](#–ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ-—Å–ª—É—á–∞–∏)
7. [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã)

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ TDD

Test-Driven Development (TDD) - —ç—Ç–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –≥–¥–µ —Ç–µ—Å—Ç—ã –ø–∏—à—É—Ç—Å—è –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞. –¶–∏–∫–ª TDD:

1. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç (Red)
3. –ù–∞–ø–∏—Å–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç (Green)
5. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (Refactor)

## –ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

### 1. –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
2. –í—ã–¥–µ–ª–∏—Ç—å –ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
4. –°–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### 2. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
1. –†–∞–∑–±–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ —á–∞—Å—Ç–∏
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
3. –°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –º–æ–∫–∏ –∏ —Å—Ç–∞–±—ã
4. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
```typescript
describe('ClassName', () => {
    describe('MethodName', () => {
        describe('Scenario', () => {
            it('should behave as expected when...', () => {
                // Arrange
                // Act
                // Assert
            });
        });
    });
});
```

## –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏

### 1. –û—Ç–∫—Ä—ã—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Public API)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∫–ª–∞—Å—Å–∞
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

–ü—Ä–∏–º–µ—Ä:
```typescript
describe('UserService', () => {
    it('should create user with valid data', () => {
        const service = new UserService();
        const user = service.createUser({
            name: 'John',
            email: 'john@example.com'
        });
        expect(user.id).toBeDefined();
    });
});
```

### 2. –ó–∞–∫—Ä—ã—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Private Implementation)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ª–æ–≥–∏–∫–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞

–ü—Ä–∏–º–µ—Ä:
```typescript
describe('PasswordHasher', () => {
    it('should properly salt password', () => {
        const hasher = new PasswordHasher();
        const result = hasher.hash('password');
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥
        expect(hasher.verify('password', result)).toBe(true);
    });
});
```

## –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º

### 1. –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
describe('Calculator', () => {
    it('should add two positive numbers', () => {
        const calc = new Calculator();
        expect(calc.add(2, 3)).toBe(5);
    });
});
```

### 2. –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```typescript
describe('Calculator', () => {
    it('should throw error when dividing by zero', () => {
        const calc = new Calculator();
        expect(() => calc.divide(5, 0)).toThrow(DivisionByZeroError);
    });
});
```

### 3. –ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ/–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –ü—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã

```typescript
describe('ArrayUtils', () => {
    it('should handle empty array', () => {
        expect(ArrayUtils.sum([])).toBe(0);
    });
    
    it('should handle array with MAX_SAFE_INTEGER', () => {
        expect(ArrayUtils.sum([Number.MAX_SAFE_INTEGER])).toBe(Number.MAX_SAFE_INTEGER);
    });
});
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º –∫–ª–∞—Å—Å–æ–≤

### 1. Entity –∫–ª–∞—Å—Å—ã
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
- –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
- –ú–µ—Ç–æ–¥—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

```typescript
describe('User', () => {
    describe('constructor', () => {
        it('should create valid user', () => {
            const user = new User('John', 'john@example.com');
            expect(user.name).toBe('John');
        });

        it('should throw on invalid email', () => {
            expect(() => new User('John', 'invalid-email'))
                .toThrow(ValidationError);
        });
    });

    describe('equals', () => {
        it('should return true for same ID', () => {
            const user1 = new User('John', 'john@example.com');
            const user2 = new User('John', 'john@example.com');
            user1.id = user2.id = 1;
            expect(user1.equals(user2)).toBe(true);
        });
    });
});
```

### 2. Value Objects
- –ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å
- –í–∞–ª–∏–¥–∞—Ü–∏—è
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
describe('Money', () => {
    describe('immutability', () => {
        it('should create new instance on operations', () => {
            const money1 = new Money(100, 'USD');
            const money2 = money1.add(new Money(50, 'USD'));
            expect(money1.amount).toBe(100);
            expect(money2.amount).toBe(150);
        });
    });

    describe('validation', () => {
        it('should not allow negative amounts', () => {
            expect(() => new Money(-100, 'USD'))
                .toThrow(ValidationError);
        });

        it('should not allow invalid currency', () => {
            expect(() => new Money(100, 'INVALID'))
                .toThrow(ValidationError);
        });
    });
});
```

### 3. Service –∫–ª–∞—Å—Å—ã
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

```typescript
describe('PaymentService', () => {
    let paymentService: PaymentService;
    let paymentGatewayMock: jest.Mocked<PaymentGateway>;
    let userRepositoryMock: jest.Mocked<UserRepository>;

    beforeEach(() => {
        paymentGatewayMock = {
            processPayment: jest.fn(),
            refund: jest.fn()
        };
        userRepositoryMock = {
            findById: jest.fn(),
            save: jest.fn()
        };
        paymentService = new PaymentService(
            paymentGatewayMock,
            userRepositoryMock
        );
    });

    describe('processPayment', () => {
        it('should process successful payment', async () => {
            // Arrange
            const userId = 1;
            const amount = new Money(100, 'USD');
            userRepositoryMock.findById.mockResolvedValue(new User('John'));
            paymentGatewayMock.processPayment.mockResolvedValue({
                success: true,
                transactionId: 'tx_123'
            });

            // Act
            const result = await paymentService.processPayment(userId, amount);

            // Assert
            expect(result.success).toBe(true);
            expect(paymentGatewayMock.processPayment).toHaveBeenCalledWith(
                amount,
                expect.any(String)
            );
        });

        it('should handle payment failure', async () => {
            // Arrange
            paymentGatewayMock.processPayment.mockRejectedValue(
                new PaymentError('Insufficient funds')
            );

            // Act & Assert
            await expect(
                paymentService.processPayment(1, new Money(100, 'USD'))
            ).rejects.toThrow(PaymentError);
        });

        it('should rollback on partial failure', async () => {
            // Arrange
            paymentGatewayMock.processPayment.mockResolvedValue({
                success: true,
                transactionId: 'tx_123'
            });
            userRepositoryMock.save.mockRejectedValue(new Error('DB Error'));

            // Act
            try {
                await paymentService.processPayment(1, new Money(100, 'USD'));
            } catch {
                // Assert
                expect(paymentGatewayMock.refund).toHaveBeenCalledWith('tx_123');
            }
        });
    });
});
```

### 4. Repository –∫–ª–∞—Å—Å—ã
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
describe('UserRepository', () => {
    let repository: UserRepository;
    let dbMock: jest.Mocked<Database>;
    let cacheMock: jest.Mocked<Cache>;

    beforeEach(() => {
        dbMock = {
            query: jest.fn(),
            transaction: jest.fn()
        };
        cacheMock = {
            get: jest.fn(),
            set: jest.fn(),
            delete: jest.fn()
        };
        repository = new UserRepository(dbMock, cacheMock);
    });

    describe('findById', () => {
        it('should return from cache if available', async () => {
            // Arrange
            const user = new User('John');
            cacheMock.get.mockResolvedValue(user);

            // Act
            const result = await repository.findById(1);

            // Assert
            expect(result).toBe(user);
            expect(dbMock.query).not.toHaveBeenCalled();
        });

        it('should fetch from DB and cache on cache miss', async () => {
            // Arrange
            const user = new User('John');
            cacheMock.get.mockResolvedValue(null);
            dbMock.query.mockResolvedValue([user]);

            // Act
            const result = await repository.findById(1);

            // Assert
            expect(result).toBe(user);
            expect(cacheMock.set).toHaveBeenCalledWith(
                expect.any(String),
                user,
                expect.any(Number)
            );
        });
    });

    describe('save', () => {
        it('should save to DB and invalidate cache', async () => {
            // Arrange
            const user = new User('John');

            // Act
            await repository.save(user);

            // Assert
            expect(dbMock.query).toHaveBeenCalled();
            expect(cacheMock.delete).toHaveBeenCalled();
        });

        it('should handle transaction rollback', async () => {
            // Arrange
            dbMock.query.mockRejectedValue(new Error('DB Error'));

            // Act & Assert
            await expect(repository.save(new User('John')))
                .rejects.toThrow('DB Error');
        });
    });
});
```

### 5. Controller/Handler –∫–ª–∞—Å—Å—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ú–∞–ø–ø–∏–Ω–≥ DTO
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- HTTP –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

```typescript
describe('UserController', () => {
    let controller: UserController;
    let userServiceMock: jest.Mocked<UserService>;
    let validatorMock: jest.Mocked<Validator>;

    beforeEach(() => {
        userServiceMock = {
            createUser: jest.fn(),
            updateUser: jest.fn(),
            deleteUser: jest.fn()
        };
        validatorMock = {
            validate: jest.fn()
        };
        controller = new UserController(userServiceMock, validatorMock);
    });

    describe('createUser', () => {
        it('should return 201 on successful creation', async () => {
            // Arrange
            const dto = { name: 'John', email: 'john@example.com' };
            validatorMock.validate.mockResolvedValue(true);
            userServiceMock.createUser.mockResolvedValue(new User('John'));

            // Act
            const response = await controller.createUser(dto);

            // Assert
            expect(response.statusCode).toBe(201);
            expect(response.body).toHaveProperty('id');
        });

        it('should return 400 on validation failure', async () => {
            // Arrange
            validatorMock.validate.mockResolvedValue(false);

            // Act
            const response = await controller.createUser({});

            // Assert
            expect(response.statusCode).toBe(400);
        });

        it('should return 409 on duplicate email', async () => {
            // Arrange
            validatorMock.validate.mockResolvedValue(true);
            userServiceMock.createUser.mockRejectedValue(
                new DuplicateEmailError()
            );

            // Act
            const response = await controller.createUser({
                name: 'John',
                email: 'existing@example.com'
            });

            // Assert
            expect(response.statusCode).toBe(409);
        });
    });
});
```

## –ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### 1. –ß–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ/–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–∏–ø–∞
- –ù–æ–ª—å
- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
- –î—Ä–æ–±–∏
- NaN/Infinity

```typescript
describe('NumberValidator', () => {
    const validator = new NumberValidator();

    describe('validate', () => {
        it.each([
            [Number.MIN_SAFE_INTEGER, true],
            [Number.MAX_SAFE_INTEGER, true],
            [0, true],
            [-1, true],
            [0.1, true],
            [NaN, false],
            [Infinity, false],
            [-Infinity, false]
        ])('should validate %p as %p', (input, expected) => {
            expect(validator.validate(input)).toBe(expected);
        });
    });
});
```

### 2. –°—Ç—Ä–æ–∫–∏
- –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
- –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
- –°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã
- –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç
- Unicode —Å–∏–º–≤–æ–ª—ã

```typescript
describe('StringValidator', () => {
    const validator = new StringValidator();

    describe('validate', () => {
        it.each([
            ['', false],
            ['a'.repeat(1000), false],
            ['Hello\nWorld', true],
            ['Hello!@#$%^&*()', true],
            ['–ü—Ä–∏–≤–µ—Ç –º–∏—Ä', true],
            ['üåçüåéüåè', true]
        ])('should validate %p as %p', (input, expected) => {
            expect(validator.validate(input)).toBe(expected);
        });
    });
});
```

### 3. –ú–∞—Å—Å–∏–≤—ã
- –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
- –û–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç
- –ú–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –î—É–±–ª–∏–∫–∞—Ç—ã
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã

```typescript
describe('ArrayUtils', () => {
    describe('unique', () => {
        it.each([
            [[], []],
            [[1], [1]],
            [[1, 1, 2, 2], [1, 2]],
            [[1, [2, 2], 3], [1, [2, 2], 3]]
        ])('should handle %p and return %p', (input, expected) => {
            expect(ArrayUtils.unique(input)).toEqual(expected);
        });
    });
});
```

### 4. –û–±—ä–µ–∫—Ç—ã
- –ü—É—Å—Ç–æ–π –æ–±—ä–µ–∫—Ç
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
- Null –∑–Ω–∞—á–µ–Ω–∏—è
- –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
- –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

```typescript
describe('ObjectValidator', () => {
    describe('validate', () => {
        it('should handle empty object', () => {
            expect(ObjectValidator.validate({})).toBe(false);
        });

        it('should handle missing optional fields', () => {
            const obj = { required: 'value' };
            expect(ObjectValidator.validate(obj)).toBe(true);
        });

        it('should handle null values', () => {
            const obj = { field: null };
            expect(ObjectValidator.validate(obj)).toBe(false);
        });

        it('should handle inherited properties', () => {
            class Parent {
                parentField = 'value';
            }
            class Child extends Parent {
                childField = 'value';
            }
            expect(ObjectValidator.validate(new Child())).toBe(true);
        });
    });
});
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```typescript
describe('AuthService', () => {
    let authService: AuthService;
    let userRepositoryMock: jest.Mocked<UserRepository>;
    let tokenServiceMock: jest.Mocked<TokenService>;
    let hasherMock: jest.Mocked<PasswordHasher>;

    beforeEach(() => {
        userRepositoryMock = {
            findByEmail: jest.fn(),
            save: jest.fn()
        };
        tokenServiceMock = {
            generateToken: jest.fn(),
            verifyToken: jest.fn(),
            revokeToken: jest.fn()
        };
        hasherMock = {
            hash: jest.fn(),
            verify: jest.fn()
        };
        authService = new AuthService(
            userRepositoryMock,
            tokenServiceMock,
            hasherMock
        );
    });

    describe('login', () => {
        it('should authenticate valid credentials', async () => {
            // Arrange
            const credentials = {
                email: 'user@example.com',
                password: 'password123'
            };
            const user = new User('Test User');
            userRepositoryMock.findByEmail.mockResolvedValue(user);
            hasherMock.verify.mockResolvedValue(true);
            tokenServiceMock.generateToken.mockResolvedValue('token');

            // Act
            const result = await authService.login(credentials);

            // Assert
            expect(result.success).toBe(true);
            expect(result.token).toBe('token');
        });

        it('should fail with invalid email', async () => {
            // Arrange
            userRepositoryMock.findByEmail.mockResolvedValue(null);

            // Act & Assert
            await expect(authService.login({
                email: 'invalid@example.com',
                password: 'password123'
            })).rejects.toThrow(AuthenticationError);
        });

        it('should fail with invalid password', async () => {
            // Arrange
            userRepositoryMock.findByEmail.mockResolvedValue(new User('Test'));
            hasherMock.verify.mockResolvedValue(false);

            // Act & Assert
            await expect(authService.login({
                email: 'user@example.com',
                password: 'wrongpass'
            })).rejects.toThrow(AuthenticationError);
        });

        it('should handle locked account', async () => {
            // Arrange
            const lockedUser = new User('Locked User');
            lockedUser.locked = true;
            userRepositoryMock.findByEmail.mockResolvedValue(lockedUser);

            // Act & Assert
            await expect(authService.login({
                email: 'locked@example.com',
                password: 'password123'
            })).rejects.toThrow(AccountLockedError);
        });
    });

    describe('logout', () => {
        it('should revoke token', async () => {
            // Arrange
            const token = 'valid_token';
            tokenServiceMock.verifyToken.mockResolvedValue({ userId: 1 });

            // Act
            await authService.logout(token);

            // Assert
            expect(tokenServiceMock.revokeToken).toHaveBeenCalledWith(token);
        });

        it('should handle invalid token', async () => {
            // Arrange
            tokenServiceMock.verifyToken.mockRejectedValue(
                new TokenValidationError()
            );

            // Act & Assert
            await expect(authService.logout('invalid_token'))
                .rejects.toThrow(TokenValidationError);
        });
    });
});
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º

```typescript
describe('FormValidator', () => {
    let validator: FormValidator;

    beforeEach(() => {
        validator = new FormValidator();
    });

    describe('validateRegistrationForm', () => {
        const validForm = {
            username: 'johndoe',
            email: 'john@example.com',
            password: 'Password123!',
            confirmPassword: 'Password123!',
            age: 25
        };

        it('should pass with valid data', () => {
            expect(validator.validate(validForm)).toEqual({
                valid: true,
                errors: {}
            });
        });

        describe('username validation', () => {
            it.each([
                ['', 'Username is required'],
                ['a', 'Username must be at least 3 characters'],
                ['a'.repeat(51), 'Username must be at most 50 characters'],
                ['user@name', 'Username can only contain letters, numbers and underscores'],
                ['admin', 'Username is reserved']
            ])('should validate username %p', (username, expectedError) => {
                const form = { ...validForm, username };
                const result = validator.validate(form);
                expect(result.valid).toBe(false);
                expect(result.errors.username).toBe(expectedError);
            });
        });

        describe('email validation', () => {
            it.each([
                ['', 'Email is required'],
                ['notanemail', 'Invalid email format'],
                ['test@', 'Invalid email format'],
                ['@example.com', 'Invalid email format'],
                ['a'.repeat(100) + '@example.com', 'Email is too long']
            ])('should validate email %p', (email, expectedError) => {
                const form = { ...validForm, email };
                const result = validator.validate(form);
                expect(result.valid).toBe(false);
                expect(result.errors.email).toBe(expectedError);
            });
        });

        describe('password validation', () => {
            it.each([
                ['', 'Password is required'],
                ['short', 'Password must be at least 8 characters'],
                ['onlylowercase', 'Password must contain at least one uppercase letter'],
                ['ONLYUPPERCASE', 'Password must contain at least one lowercase letter'],
                ['NoNumbers!', 'Password must contain at least one number'],
                ['NoSpecial1', 'Password must contain at least one special character']
            ])('should validate password %p', (password, expectedError) => {
                const form = { ...validForm, password, confirmPassword: password };
                const result = validator.validate(form);
                expect(result.valid).toBe(false);
                expect(result.errors.password).toBe(expectedError);
            });

            it('should validate password confirmation', () => {
                const form = {
                    ...validForm,
                    confirmPassword: 'DifferentPassword123!'
                };
                const result = validator.validate(form);
                expect(result.valid).toBe(false);
                expect(result.errors.confirmPassword)
                    .toBe('Passwords do not match');
            });
        });

        describe('age validation', () => {
            it.each([
                [null, 'Age is required'],
                [-1, 'Age must be positive'],
                [17, 'Must be at least 18 years old'],
                [151, 'Invalid age'],
                [25.5, 'Age must be a whole number']
            ])('should validate age %p', (age, expectedError) => {
                const form = { ...validForm, age };
                const result = validator.validate(form);
                expect(result.valid).toBe(false);
                expect(result.errors.age).toBe(expectedError);
            });
        });
    });
});
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

```typescript
describe('OrderService', () => {
    let orderService: OrderService;
    let productRepositoryMock: jest.Mocked<ProductRepository>;
    let orderRepositoryMock: jest.Mocked<OrderRepository>;
    let paymentServiceMock: jest.Mocked<PaymentService>;
    let inventoryServiceMock: jest.Mocked<InventoryService>;

    beforeEach(() => {
        productRepositoryMock = {
            findById: jest.fn(),
            save: jest.fn()
        };
        orderRepositoryMock = {
            create: jest.fn(),
            save: jest.fn(),
            findById: jest.fn()
        };
        paymentServiceMock = {
            processPayment: jest.fn(),
            refundPayment: jest.fn()
        };
        inventoryServiceMock = {
            checkAvailability: jest.fn(),
            reserveItems: jest.fn(),
            releaseItems: jest.fn()
        };

        orderService = new OrderService(
            productRepositoryMock,
            orderRepositoryMock,
            paymentServiceMock,
            inventoryServiceMock
        );
    });

    describe('createOrder', () => {
        const orderData = {
            userId: 1,
            items: [
                { productId: 1, quantity: 2 },
                { productId: 2, quantity: 1 }
            ],
            shippingAddress: {
                street: '123 Main St',
                city: 'Test City',
                country: 'Test Country',
                postalCode: '12345'
            },
            paymentMethod: {
                type: 'CREDIT_CARD',
                cardNumber: '**** **** **** 1234',
                expiryDate: '12/25'
            }
        };

        const mockProducts = [
            { id: 1, price: 100, name: 'Product 1' },
            { id: 2, price: 150, name: 'Product 2' }
        ];

        beforeEach(() => {
            // Setup common mock responses
            productRepositoryMock.findById.mockImplementation(async (id) => 
                mockProducts.find(p => p.id === id)
            );
            inventoryServiceMock.checkAvailability.mockResolvedValue(true);
            inventoryServiceMock.reserveItems.mockResolvedValue(true);
            paymentServiceMock.processPayment.mockResolvedValue({
                success: true,
                transactionId: 'tx_123'
            });
        });

        it('should create order successfully', async () => {
            // Arrange
            const expectedTotal = 350; // (100 * 2) + (150 * 1)

            // Act
            const result = await orderService.createOrder(orderData);

            // Assert
            expect(result.success).toBe(true);
            expect(result.order.total).toBe(expectedTotal);
            expect(inventoryServiceMock.reserveItems).toHaveBeenCalled();
            expect(paymentServiceMock.processPayment).toHaveBeenCalledWith(
                expectedTotal,
                orderData.paymentMethod
            );
        });

        it('should fail when product not found', async () => {
            // Arrange
            productRepositoryMock.findById.mockResolvedValue(null);

            // Act & Assert
            await expect(orderService.createOrder(orderData))
                .rejects.toThrow(ProductNotFoundError);
        });

        it('should fail when insufficient inventory', async () => {
            // Arrange
            inventoryServiceMock.checkAvailability.mockResolvedValue(false);

            // Act & Assert
            await expect(orderService.createOrder(orderData))
                .rejects.toThrow(InsufficientInventoryError);
        });

        it('should rollback on payment failure', async () => {
            // Arrange
            paymentServiceMock.processPayment.mockRejectedValue(
                new PaymentError('Payment declined')
            );

            // Act
            try {
                await orderService.createOrder(orderData);
            } catch (error) {
                // Assert
                expect(error).toBeInstanceOf(PaymentError);
                expect(inventoryServiceMock.releaseItems).toHaveBeenCalled();
            }
        });

        it('should handle concurrent inventory updates', async () => {
            // Arrange
            let firstCheck = true;
            inventoryServiceMock.checkAvailability.mockImplementation(() => {
                if (firstCheck) {
                    firstCheck = false;
                    return Promise.resolve(true);
                }
                return Promise.resolve(false);
            });

            // Act & Assert
            await expect(orderService.createOrder(orderData))
                .rejects.toThrow(ConcurrencyError);
        });
    });

    describe('calculateDiscount', () => {
        it.each([
            [100, 0, 100],    // No discount
            [100, 10, 90],    // 10% discount
            [100, 100, 0],    // 100% discount
            [100, 110, 0]     // Discount > 100%
        ])('should calculate total %p with discount %p% as %p', 
            (amount, discountPercent, expected) => {
                expect(orderService.calculateDiscount(amount, discountPercent))
                    .toBe(expected);
        });
    });
});
```

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã TDD —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–ª–∞—Å—Å–æ–≤ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å–∫—Ä—ã–ª –∫–∞–∫–æ–π-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞—Å–ø–µ–∫—Ç? 

# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ TDD —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é Flutter –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ –≤–æ Flutter

| –¢–∏–ø —Ç–µ—Å—Ç–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|-----------|----------|-------------|------------|-------------|
| Unit —Ç–µ—Å—Ç—ã | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–π | `test`, `mockito` | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, —Å–µ—Ä–≤–∏—Å—ã, —É—Ç–∏–ª–∏—Ç—ã | - –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ<br>- –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ<br>- –õ–µ–≥–∫–æ–µ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ |
| Widget —Ç–µ—Å—Ç—ã | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤ | `flutter_test`, `WidgetTester` | UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ñ–æ—Ä–º—ã, –∞–Ω–∏–º–∞—Ü–∏–∏ | - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞<br>- –°–∏–º—É–ª—è—Ü–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è<br>- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π |
| Integration —Ç–µ—Å—Ç—ã | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ | `integration_test` | –ü–æ–ª–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã, –Ω–∞–≤–∏–≥–∞—Ü–∏—è, –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã | - End-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ<br>- –†–µ–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ<br>- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ |
| Golden —Ç–µ—Å—Ç—ã | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è | `golden_toolkit` | UI –¥–∏–∑–∞–π–Ω, –≤–µ—Ä—Å—Ç–∫–∞, —Ç–µ–º–∏–∑–∞—Ü–∏—è | - –ü–∏–∫—Å–µ–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ<br>- –†–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã —ç–∫—Ä–∞–Ω–∞<br>- –†–∞–∑–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã |
| Performance —Ç–µ—Å—Ç—ã | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | `flutter_driver` | –°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã, –ø–∞–º—è—Ç—å, CPU | - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<br>- –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ<br>- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è |

### 1. Unit —Ç–µ—Å—Ç—ã
```typescript
describe('ClassName', () => {
    describe('MethodName', () => {
        describe('Scenario', () => {
            it('should behave as expected when...', () => {
                // Arrange
                // Act
                // Assert
            });
        });
    });
});
```

### 2. Widget —Ç–µ—Å—Ç—ã
```typescript
describe('ClassName', () => {
    describe('MethodName', () => {
        describe('Scenario', () => {
            it('should behave as expected when...', () => {
                // Arrange
                // Act
                // Assert
            });
        });
    });
});
```

### 3. Integration —Ç–µ—Å—Ç—ã
```typescript
describe('ClassName', () => {
    describe('MethodName', () => {
        describe('Scenario', () => {
            it('should behave as expected when...', () => {
                // Arrange
                // Act
                // Assert
            });
        });
    });
});
```

### 4. Golden —Ç–µ—Å—Ç—ã
```typescript
describe('ClassName', () => {
    describe('MethodName', () => {
        describe('Scenario', () => {
            it('should behave as expected when...', () => {
                // Arrange
                // Act
                // Assert
            });
        });
    });
});
```

### 5. Performance —Ç–µ—Å—Ç—ã
```typescript
describe('ClassName', () => {
    describe('MethodName', () => {
        describe('Scenario', () => {
            it('should behave as expected when...', () => {
                // Arrange
                // Act
                // Assert
            });
        });
    });
}); 